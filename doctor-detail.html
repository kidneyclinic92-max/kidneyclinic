<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Doctor Details | Clinic</title>
  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700&display=swap" rel="stylesheet" />
  <link rel="stylesheet" href="./assets/css/styles.css" />
  <style>
    body { background: #0a1929 !important; color: #e3e8ef; }
    .doctor-hero {
      min-height: 50vh;
      display: flex;
      align-items: center;
      justify-content: center;
      background: linear-gradient(rgba(10,25,41,0.8), rgba(10,25,41,0.9)), var(--hero-bg) center/cover;
      border-bottom: 1px solid rgba(255,255,255,0.1);
      padding: 60px 20px;
    }
    .doctor-hero-content {
      max-width: 1200px;
      margin: 0 auto;
      display: grid;
      grid-template-columns: 300px 1fr;
      gap: 40px;
      align-items: center;
    }
    .doctor-photo {
      width: 100%;
      aspect-ratio: 1;
      border-radius: 20px;
      object-fit: cover;
      border: 3px solid var(--accent);
      box-shadow: 0 10px 40px rgba(30,58,138,0.6);
    }
    .doctor-info h1 {
      font-size: 2.5rem;
      margin: 0 0 10px;
      color: #ffffff;
    }
    .doctor-info .title {
      font-size: 1.2rem;
      color: var(--accent);
      margin-bottom: 10px;
      font-weight: 600;
    }
    .doctor-info .specialization {
      font-size: 1.1rem;
      color: #94a3b8;
      margin-bottom: 20px;
    }
    .doctor-details {
      padding: 60px 20px;
    }
    .doctor-bio {
      margin-bottom: 40px;
      line-height: 1.8;
      font-size: 1.1rem;
      text-align: center;
    }
    .doctor-bio h2 {
      color: var(--accent);
      margin-top: 0;
      margin-bottom: 20px;
      text-align: center;
    }
    .doctor-bio p {
      text-align: center;
      max-width: 800px;
      margin: 0 auto;
    }
    .doctor-video {
      background: #1e293b;
      border: 1px solid rgba(59,130,246,0.3);
      border-radius: 14px;
      padding: 30px;
      margin-bottom: 40px;
      box-shadow: 0 0 30px rgba(30,58,138,0.4);
    }
    .doctor-video h2 {
      margin-top: 0;
      margin-bottom: 20px;
      color: var(--accent);
      text-align: center;
    }
    .video-wrapper {
      position: relative;
      padding-bottom: 56.25%;
      height: 0;
      overflow: hidden;
      border-radius: 10px;
      background: rgba(0, 0, 0, 0.5);
      box-shadow: 0 0 20px rgba(30,58,138,0.5);
    }
    .video-wrapper iframe {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      border: none;
    }
    .loading {
      text-align: center;
      padding: 60px 20px;
      color: #94a3b8;
    }
    .error {
      text-align: center;
      padding: 60px 20px;
      color: var(--accent);
    }
    .doctor-bio p {
      color: #cbd5e1;
    }
    @media (max-width: 768px) {
      .doctor-hero-content {
        grid-template-columns: 1fr;
        text-align: center;
      }
      .doctor-photo {
        max-width: 250px;
        margin: 0 auto;
      }
      .doctor-info h1 {
        font-size: 2rem;
      }
    }
  </style>
</head>
<body>
  <div id="site-header"></div>
  
  <main id="main-content">
    <div class="loading">
      <h2>Loading doctor details...</h2>
    </div>
  </main>

  <div id="site-footer"></div>
  
  <script src="./assets/js/layout.js" defer></script>
  <script src="./assets/js/animation.js" defer></script>
  <script>
    const API_BASE = 'https://kidney-clinic-e2f6c7fnf0cxg5dy.eastus-01.azurewebsites.net';
    
    async function loadDoctorDetails() {
      try {
        // Get doctor ID from URL parameter
        const urlParams = new URLSearchParams(window.location.search);
        const doctorId = urlParams.get('id');
        
        if (!doctorId) {
          throw new Error('No doctor ID provided');
        }
        
        // Fetch doctor from API
        const response = await fetch(`${API_BASE}/api/doctors/${doctorId}`);
        if (!response.ok) {
          throw new Error('Doctor not found');
        }
        
        const doctor = await response.json();
        
        // Update page title
        document.title = `${doctor.name} | Clinic`;
        
        // Set hero background if photo exists
        if (doctor.photoUrl) {
          document.documentElement.style.setProperty('--hero-bg', `url(${doctor.photoUrl})`);
        }
        
        // Render doctor details
        const mainContent = document.getElementById('main-content');
        mainContent.innerHTML = `
          <section class="doctor-hero">
            <div class="doctor-hero-content">
              ${doctor.photoUrl ? `
                <img src="${doctor.photoUrl}" alt="${doctor.name}" class="doctor-photo" />
              ` : ''}
              <div class="doctor-info">
                <h1>${doctor.name}</h1>
                ${doctor.title ? `<div class="title">${doctor.title}</div>` : ''}
                ${doctor.specialization ? `<div class="specialization">${doctor.specialization}</div>` : ''}
              </div>
            </div>
          </section>

          <section class="doctor-details">
            <div class="container">
              ${doctor.bio ? `
                <div class="doctor-bio">
                  <h2>About ${doctor.name}</h2>
                  <p>${doctor.bio}</p>
                </div>
              ` : ''}

              ${doctor.employment ? `
                <div class="doctor-bio">
                  <h2>Employment</h2>
                  <p>${doctor.employment}</p>
                </div>
              ` : ''}

              ${doctor.contact ? `
                <div class="doctor-bio">
                  <h2>Contact</h2>
                  <p>${doctor.contact}</p>
                </div>
              ` : ''}
              
              ${doctor.interviewUrl ? `
                <div class="doctor-video">
                  <h2>Watch Interview</h2>
                  <div class="video-wrapper">
                    <iframe 
                      src="${doctor.interviewUrl.replace('watch?v=', 'embed/')}" 
                      allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" 
                      allowfullscreen
                      loading="lazy"
                    ></iframe>
                  </div>
                </div>
              ` : ''}

              <div style="text-align: center; margin-top: 60px;">
                <a href="contact.html" class="btn primary" style="font-size: 1.1rem; padding: 15px 40px;">Book an Appointment</a>
              </div>
            </div>
          </section>
        `;
        
      } catch (error) {
        console.error('Error loading doctor:', error);
        document.getElementById('main-content').innerHTML = `
          <div class="error">
            <h2>Doctor Not Found</h2>
            <p>${error.message}</p>
            <a href="doctors.html" class="btn primary" style="margin-top: 20px; display: inline-block;">Back to Doctors</a>
          </div>
        `;
      }
    }
    
    // Load doctor details when page loads
    document.addEventListener('DOMContentLoaded', loadDoctorDetails);
  </script>
</body>
</html>

